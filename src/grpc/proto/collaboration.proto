syntax = "proto3";

package collaboration;

service CollaborationService {
  // Comments
  rpc ListComments (ListCommentsRequest) returns (ListCommentsResponse);
  rpc GetComment (GetCommentRequest) returns (GetCommentResponse);
  rpc CreateComment (CreateCommentRequest) returns (CreateCommentResponse);
  rpc UpdateComment (UpdateCommentRequest) returns (UpdateCommentResponse);
  rpc DeleteComment (DeleteCommentRequest) returns (DeleteCommentResponse);
  
  // Time Logs
  rpc ListTimeLogs (ListTimeLogsRequest) returns (ListTimeLogsResponse);
  rpc GetTimeLog (GetTimeLogRequest) returns (GetTimeLogResponse);
  rpc CreateTimeLog (CreateTimeLogRequest) returns (CreateTimeLogResponse);
}

message ListCommentsRequest {
  string user_id = 1;
  string commentable_type = 2; // task, project, ticket
  string commentable_id = 3;
  int32 page = 4;
  int32 limit = 5;
  string sort_by = 6;
  string sort_order = 7;
  bool include_deleted = 8;
}

message ListCommentsResponse {
  repeated Comment comments = 1;
  Pagination pagination = 2;
}

message GetCommentRequest {
  string id = 1;
  string user_id = 2;
}

message GetCommentResponse {
  Comment comment = 1;
}

message CreateCommentRequest {
  string user_id = 1;
  string commentable_type = 2; // task, project, ticket
  string commentable_id = 3;
  string comment_text = 4;
  string parent_comment_id = 5;
}

message CreateCommentResponse {
  Comment comment = 1;
}

message UpdateCommentRequest {
  string id = 1;
  string user_id = 2;
  string comment_text = 3;
}

message UpdateCommentResponse {
  Comment comment = 1;
}

message DeleteCommentRequest {
  string id = 1;
  string user_id = 2;
}

message DeleteCommentResponse {
  string message = 1;
}

message Comment {
  string id = 1;
  string commentable_type = 2;
  string commentable_id = 3;
  string user_id = 4;
  string comment_text = 5;
  string parent_comment_id = 6;
  bool is_deleted = 7;
  string deleted_at = 8;
  string created_at = 9;
  string updated_at = 10;
  User user = 11;
  repeated Mention mentions = 12;
}

message Mention {
  string id = 1;
  string mentioned_user_id = 2;
  User mentioned_user = 3;
  string created_at = 4;
}

message User {
  string id = 1;
  string email = 2;
  string first_name = 3;
  string last_name = 4;
}

message Pagination {
  int32 page = 1;
  int32 limit = 2;
  int32 total = 3;
  int32 total_pages = 4;
  bool has_next = 5;
  bool has_previous = 6;
}

message ListTimeLogsRequest {
  string task_id = 1;
  string user_id = 2;
}

message ListTimeLogsResponse {
  repeated TimeLog time_logs = 1;
}

message GetTimeLogRequest {
  string id = 1;
  string user_id = 2;
}

message GetTimeLogResponse {
  TimeLog time_log = 1;
}

message CreateTimeLogRequest {
  string user_id = 1;
  string task_id = 2;
  double hours_logged = 3;
  string log_date = 4;
  string description = 5;
  bool is_billable = 6;
}

message CreateTimeLogResponse {
  TimeLog time_log = 1;
}

message TimeLog {
  string id = 1;
  string task_id = 2;
  string user_id = 3;
  double hours_logged = 4;
  string log_date = 5;
  string description = 6;
  bool is_billable = 7;
  string created_at = 8;
}

